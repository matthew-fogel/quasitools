<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>hydra - quasitools</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="../stylesheets/extra.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "hydra";
    var mkdocs_page_input_path = "hydra.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> quasitools</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../requirements/">Requirements</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../installation/">Installation</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../formats/">Data Formats</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Tools</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../aacoverage/">aacoverage</a>
                </li>
                <li class="">
                    
    <a class="" href="../aavar/">call aavr</a>
                </li>
                <li class="">
                    
    <a class="" href="../codonvar/">call codonvar</a>
                </li>
                <li class="">
                    
    <a class="" href="../ntvar/">call ntvar</a>
                </li>
                <li class="">
                    
    <a class="" href="../complexity/">complexity</a>
                </li>
                <li class="">
                    
    <a class="" href="../consensus/">consensus</a>
                </li>
                <li class="">
                    
    <a class="" href="../distance/">distance</a>
                </li>
                <li class="">
                    
    <a class="" href="../dnds/">dnds</a>
                </li>
                <li class="">
                    
    <a class="" href="../drmutations/">drmutations</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">hydra</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#hydra">HyDRA</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#basic-usage">Basic Usage</a></li>
        
            <li><a class="toctree-l4" href="#arguments">Arguments</a></li>
        
            <li><a class="toctree-l4" href="#options">Options</a></li>
        
            <li><a class="toctree-l4" href="#output_1">Output</a></li>
        
            <li><a class="toctree-l4" href="#example">Example</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../quality/">quality</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../contact/">Contact</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../legal/">Legal</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">quasitools</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Tools &raquo;</li>
        
      
    
    <li>hydra</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="hydra">HyDRA</h1>
<p>HyDRA is an annotated reference-based bioinformatics pipeline, which analyzes next-generation sequencing data for genotyping HIV-1 drug resistance mutation. It utilizes an annotated HXB2 sequence for reference mapping by Bowtie2, and stringent data quality assurance and variant calling to identify HIV drug resistant (HIVDR) associated mutations based on the <a href="https://hivdb.stanford.edu/">Stanford HIV Drug Resistance Database</a> and the 2009 WHO list for Sruveillance of Transmitted HIVDR. All HIVDR mutations found in the <em>pol</em> gene; <em>protease</em> (PR), <em>reverse transcriptase</em> (RT), and <em>integrase</em> (IN) are reported according to classifications outlined in the <a href="https://hivdb.stanford.edu/pages/surveillance.html">Stanford Surveillance Drug Resistance Mutation list</a>.</p>
<h2 id="basic-usage">Basic Usage</h2>
<pre><code class="bash">quasitools hydra [OPTIONS] &lt;FORWARD READS&gt; [REVERSE READS]
</code></pre>

<h2 id="arguments">Arguments</h2>
<h3 id="forward-reads">Forward Reads</h3>
<p>The forward or single-end FASTQ-format reads. HyDRA will attempt to identify known drug resistant mutations in these reads.</p>
<h3 id="reverse-reads">Reverse Reads</h3>
<p>This parameter is optional. If provided, these reads will be assumed to be paired with the provided forward reads and HyDRA will attempt to identify known drug resistant mutations in both sets of reads.</p>
<h2 id="options">Options</h2>
<h3 id="output">Output</h3>
<pre><code class="text">-o, --output DIRECTORY
</code></pre>

<p>The location of the output directory, which will contain several files created from HyDRA's operation, including any identified drug resistant mutations.</p>
<h3 id="mutation-database">Mutation Database</h3>
<pre><code class="text">-m, --mutation_db FILE
</code></pre>

<p>The mutation database describes specific mutations within the named genetic regions specified previously in the BED4 file. When provided to the tool. The entries in the "genetic regions" colummn of this database must match the "names" column of the provided BED4 file. Please refer to <a href="../formats">Data Formats</a> for more information.</p>
<h3 id="reporting-threshold">Reporting Threshold</h3>
<pre><code class="text">-rt, --reporting_threshold INTEGER
</code></pre>

<p>The minimum number of observations required in the read data (FASTQ file) for an entry to be reported in the drug resistance report. Mutations with a number of observations less than this will not be reported. The default value is 1. </p>
<h3 id="generate-consensus">Generate Consensus</h3>
<pre><code class="text">-gc, --generate_consensus
</code></pre>

<p>When this flag is set, the consensus sequence of the provided reads will be reported in the HyDRA output.</p>
<h3 id="consensus-percentage">Consensus Percentage</h3>
<pre><code class="text">-cp, --consensus_pct INTEGER
</code></pre>

<p>The minimum percentage of observations for an observation to be incorporated into the consensus. This option must be used with the <code>-gc/--generate_consensus</code> flag turned.</p>
<p>This option causes the consensus construction to operate in one of two distinct modes. When the percentage is set to exactly <code>100</code>, then the consensus is generated using by taking the most abundant base at each position. In contrast, when the percentage is less than <code>100</code>, then the consensus is generated by comparing the frequency of each base at a position against the treshold. The default value is <code>100</code>.</p>
<p>These two modes of operation are described in greater detail within the description for <a href="../consensus">quasitools consensus</a>.</p>
<h3 id="quiet">Quiet</h3>
<pre><code class="text">-q, --quiet
</code></pre>

<p>This flag is used to suppress all standard output throughout the pipeline. However, this does not affect any file generation.</p>
<h3 id="trim-reads">Trim Reads</h3>
<pre><code class="text">-tr, --trim_reads
</code></pre>

<p>When this flag is enabled, the pipeline will iteratively trim the ends of reads until they either meet filter values or become too short. If trimmed reads become too short, they will be discarded. When this flag is not enabled, the pipeline will remove reads which do not meet filter values.</p>
<h3 id="mask-reads">Mask Reads</h3>
<pre><code class="text">-mr, --mask_reads
</code></pre>

<p>This option will mask low quality regions with "N" if they are below the minimum read quality threshold. This option and N-filtering cannot be enabled simultaneously.</p>
<h3 id="minimum-read-quality">Minimum Read Quality</h3>
<pre><code class="text">-rq, --min_read_qual INTEGER
</code></pre>

<p>When read masking is enabled, this parameter is the minimum quality that a position must have in a read must have. If below this threshold, the position will be masked as an <code>N</code>.</p>
<h3 id="length-cutoff">Length Cutoff</h3>
<pre><code class="text">-lc, --length_cutoff INTEGER
</code></pre>

<p>Reads which fall short of the specified length will be filtered out.</p>
<h3 id="mean-or-median-score">Mean or Median Score</h3>
<pre><code class="text">-me, --median / -mn, --mean
</code></pre>

<p>This determines whether the pipeline will use a mean or median (default) score as a cutoff for read filtering.</p>
<h3 id="score-cutoff">Score Cutoff</h3>
<pre><code class="text">-sc, --score_cutoff INTEGER
</code></pre>

<p>Reads that have a median or mean quality score (depending on the score type specified) less than the score cutoff value will be filtered out.</p>
<h3 id="filter-ns">Filter Ns</h3>
<pre><code class="text">-n, --ns
</code></pre>

<p>If enabled, the pipeline will discard any reads that contain <code>N</code> characters.</p>
<h3 id="error-rate">Error Rate</h3>
<pre><code class="text">-e, --error_rate FLOAT
</code></pre>

<p>The estimated substitution sequencing error rate for the sequencing platform.</p>
<h3 id="minimum-variant-quality">Minimum Variant Quality</h3>
<pre><code class="text">-vq, --min_variant_qual INTEGER
</code></pre>

<p>Minimum quality for an amino acid variant to be included in the produced AAVF (<a href="https://github.com/winhiv/aavf-spec/raw/master/AAVFv1.0.pdf">Amino Acid Variant Format</a>) file. This minimum will affect which amino acid variants are reported.</p>
<h3 id="minimum-depth">Minimum Depth</h3>
<pre><code class="text">-md, --min_dp INTEGER
</code></pre>

<p>Minimum required read depth for observed nucleotide variants included for processing in the pipeline.</p>
<h3 id="minimum-allele-count">Minimum Allele Count</h3>
<pre><code class="text">-ma, --min_ac INTEGER
</code></pre>

<p>The minimum required allele count for observed nucleotide variants to be included for processing in the pipeline.</p>
<h3 id="minimum-frequency">Minimum Frequency</h3>
<pre><code class="text">-mf, --min_freq FLOAT
</code></pre>

<p>The minimum required frequency for observed amino acid variants to be included for processing in the pipeline.</p>
<h3 id="id">ID</h3>
<pre><code class="text">-i, --id TEXT
</code></pre>

<p>This is used to specifiy a FASTA sequence identifier to be used in the consensus report output.</p>
<h2 id="output_1">Output</h2>
<p>The output directory location will default to the current directory and will be called <code>data/</code>. It will include the following output files:</p>
<ul>
<li>align.bam</li>
<li>align.bam.bai</li>
<li>consensus.fasta</li>
<li>coverage_file.csv</li>
<li>dr_report.csv</li>
<li>filtered.fastq</li>
<li>hydra.vcf</li>
<li>mutation_report.aavf</li>
<li>stats.txt</li>
</ul>
<h2 id="example">Example</h2>
<h3 id="data">Data</h3>
<p>The following example data may be used to run the tool:</p>
<ul>
<li><a href="../data/variant.fastq">variant.fastq</a></li>
</ul>
<h3 id="command">Command</h3>
<pre><code class="bash">quasitools hydra variant.fastq -o output
</code></pre>

<h3 id="output_2">Output</h3>
<p><strong>Standard Output</strong></p>
<pre><code class="text"># Performing quality control on reads...
# Mapping reads...
# Loading read mappings...
# Identifying variants...
# Masking filtered variants...
# Building amino acid census...
# Finding amino acid mutations...
# Writing drug resistant mutation report...
</code></pre>

<p><strong>mutation_report.aavf</strong></p>
<pre><code class="text">##reference=hxb2_pol.fas
##source=quasitools:hydra
##fileformat=AAVFv1.0
##fileDate=20190215
##INFO=&lt;ID=SRVL,Number=.,Type=String,Description=&quot;Drug Resistance Surveillance&quot;&gt;
##INFO=&lt;ID=AC,Number=.,Type=String,Description=&quot;Alternate Codon&quot;&gt;
##INFO=&lt;ID=CAT,Number=.,Type=String,Description=&quot;Drug Resistance Category&quot;&gt;
##INFO=&lt;ID=ACF,Number=.,Type=Float,Description=&quot;Alternate Codon Frequency,for each Alternate Codon,in the same order aslisted.&quot;&gt;
##INFO=&lt;ID=RC,Number=1,Type=String,Description=&quot;Reference Codon&quot;&gt;
##FILTER=&lt;ID=af0.01,Description=&quot;Set if True; alt_freq&lt;0.01&quot;&gt;
#CHROM  GENE    POS     REF     ALT     FILTER  ALT_FREQ        COVERAGE        INFO
hxb2_pol        PR      85      I       S       PASS    1.0000  144     SRVL=.;AC=aGt;CAT=.;ACF=1.0000;RC=att
hxb2_pol        RT      91      Q       H       PASS    1.0000  131     SRVL=.;AC=caT;CAT=.;ACF=1.0000;RC=caa
hxb2_pol        PR      40      G       E       PASS    1.0000  122     SRVL=.;AC=gAa;CAT=.;ACF=1.0000;RC=gga
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../quality/" class="btn btn-neutral float-right" title="quality">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../drmutations/" class="btn btn-neutral" title="drmutations"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright Government of Canada 2017-2019</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../drmutations/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../quality/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
