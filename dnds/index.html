<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>dnds - quasitools</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="../stylesheets/extra.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "dnds";
    var mkdocs_page_input_path = "dnds.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> quasitools</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../requirements/">Requirements</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../installation/">Installation</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../formats/">Data Formats</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Tools</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../aacoverage/">aacoverage</a>
                </li>
                <li class="">
                    
    <a class="" href="../aavar/">call aavr</a>
                </li>
                <li class="">
                    
    <a class="" href="../codonvar/">call codonvar</a>
                </li>
                <li class="">
                    
    <a class="" href="../ntvar/">call ntvar</a>
                </li>
                <li class="">
                    
    <a class="" href="../complexity/">complexity</a>
                </li>
                <li class="">
                    
    <a class="" href="../consensus/">consensus</a>
                </li>
                <li class="">
                    
    <a class="" href="../distance/">distance</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">dnds</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#dnds">dNdS</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#basic-usage">Basic Usage</a></li>
        
            <li><a class="toctree-l4" href="#arguments">Arguments</a></li>
        
            <li><a class="toctree-l4" href="#options">Options</a></li>
        
            <li><a class="toctree-l4" href="#example">Example</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../drmutations/">drmutations</a>
                </li>
                <li class="">
                    
    <a class="" href="../hydra/">hydra</a>
                </li>
                <li class="">
                    
    <a class="" href="../quality/">quality</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../contact/">Contact</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../legal/">Legal</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">quasitools</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Tools &raquo;</li>
        
      
    
    <li>dnds</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="dnds">dNdS</h1>
<p>Determines the dN/dS ratio for each codon variant in a supplied csv file (codon variants). The dN/dS ratio is the ratio between the number of nonsynonymous substitutions per non-synonymous site to the number of synonymous substitutions per synonymous site. </p>
<p>The reported ratio is calculated by observing by first observing what proportion of nonsynonymous and synonymous sites have mutations, pN and pS. However, pN and pS are calculated with consideration for many reads are covering the same mutation sites. pN and pS are then converted to dN and dS using the Jukes-Cantor correction, which estimates the expected proportion of changes between two sequences (unobservable), based on our observed proportions (pN and pS). The corrected Jukes-Cantor rates will be higher, because the expectation is that over time, multiple mutations will have happened at the same site and this information is lost in our observed proportions; a slightly higher mutation rate (dN and dS) would have been required to observe our proportions (pN and pS).</p>
<p>This dN/dS ratio can be used as an indicator of evolutionary pressure acting on a codon. For more information about the dN/dS calculation and how to interpret the ratio, please view <a href="https://veterinaryresearch.biomedcentral.com/articles/10.1186/1297-9716-44-12">Morelli et al. 2013</a> and <a href="https://academic.oup.com/mbe/article/3/5/418/988012">Nei and Gojobori 1986</a>.</p>
<h2 id="basic-usage">Basic Usage</h2>
<pre><code class="bash">quasitools dnds [options] &lt;codon variants csv&gt; &lt;reference file&gt; &lt;offset&gt;
</code></pre>

<h2 id="arguments">Arguments</h2>
<h3 id="codon-variants-csv">Codon Variants CSV</h3>
<p>The codon variants CSV file should be taken directly from the output of <a href="../codonvar">call codonvar</a> and provided as input when running this tool. For more information about this format, please refer to <a href="../formats">Data Formats</a>.</p>
<h3 id="reference-file">Reference File</h3>
<p>A reference file to compare the codon variants against. The provided reference file must be the same reference file used when producing the codon variants CSV file.</p>
<h3 id="offset">Offset</h3>
<p>An integer to offset the reported positions in the output. This does not change the frame or coordinates of coding sequences in the BED file.</p>
<p>It may be useful to provide an offset when providing a gene as a reference and gene products in the BED file, but want to report codon variants with respect to the entire chromosome. In this circumstance, the offset would be the position of the reference gene, with respect to the chromosome on which it resides.</p>
<h2 id="options">Options</h2>
<h3 id="output">Output</h3>
<pre><code class="text">-o, --output FILENAME
</code></pre>

<p>The file output location to write the dN/dS ratios.</p>
<h2 id="example">Example</h2>
<h3 id="data">Data</h3>
<ul>
<li><a href="../data/hiv.fasta">hiv.fasta</a></li>
<li><a href="../data/variant_codonvar.csv">variant_codonvar.csv</a></li>
</ul>
<h3 id="command">Command</h3>
<pre><code class="bash">quasitools dnds variant_codonvar.csv hiv.fasta 0
</code></pre>

<h3 id="output_1">Output</h3>
<pre><code class="text">#gene,pn,ps,pn_sites,ps_sites,dn/ds
pol,0.4345,1.5000,3,3,N/A
env,0.3750,1.0000,2,2,N/A
gag,0.4375,1.0000,4,1,N/A
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../drmutations/" class="btn btn-neutral float-right" title="drmutations">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../distance/" class="btn btn-neutral" title="distance"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright Government of Canada 2017-2019</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../distance/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../drmutations/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
