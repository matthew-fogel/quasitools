<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>call codonvar - quasitools</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="../stylesheets/extra.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "call codonvar";
    var mkdocs_page_input_path = "codonvar.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> quasitools</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../requirements/">Requirements</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../installation/">Installation</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../formats/">Data Formats</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Tools</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../aacoverage/">aacoverage</a>
                </li>
                <li class="">
                    
    <a class="" href="../aavar/">call aavr</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">call codonvar</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#codonvar">codonvar</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#basic-usage">Basic Usage</a></li>
        
            <li><a class="toctree-l4" href="#arguments">Arguments</a></li>
        
            <li><a class="toctree-l4" href="#options">Options</a></li>
        
            <li><a class="toctree-l4" href="#example">Example</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../ntvar/">call ntvar</a>
                </li>
                <li class="">
                    
    <a class="" href="../complexity/">complexity</a>
                </li>
                <li class="">
                    
    <a class="" href="../consensus/">consensus</a>
                </li>
                <li class="">
                    
    <a class="" href="../distance/">distance</a>
                </li>
                <li class="">
                    
    <a class="" href="../dnds/">dnds</a>
                </li>
                <li class="">
                    
    <a class="" href="../drmutations/">drmutations</a>
                </li>
                <li class="">
                    
    <a class="" href="../hydra/">hydra</a>
                </li>
                <li class="">
                    
    <a class="" href="../quality/">quality</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../contact/">Contact</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../legal/">Legal</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">quasitools</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Tools &raquo;</li>
        
      
    
    <li>call codonvar</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="codonvar">codonvar</h1>
<p>Call codon variants for a given <a href="https://samtools.github.io/hts-specs/SAMv1.pdf">BAM</a> alignment file. A report is generated that details nucleotide variants within codons and the resulting amino acid variants. The report indicates whether the nucleotide variants correspond to a synonymous or a non-synonymous mutation.</p>
<h2 id="basic-usage">Basic Usage</h2>
<pre><code class="bash">quasitools codonvar [options] &lt;BAM file&gt; &lt;reference file&gt; &lt;offset&gt; &lt;bed file&gt;
</code></pre>

<h2 id="arguments">Arguments</h2>
<h3 id="bam-file">BAM File</h3>
<p>A <a href="https://samtools.github.io/hts-specs/SAMv1.pdf">BAM</a> file (.bam) of sequences aligned to a related reference. A BAM index file (.bai) is also required and should be named the same as the BAM file, with the extension instead changed from ".bam" to ".bai".</p>
<h3 id="reference-file">Reference File</h3>
<p>A reference file related to the aligned BAM sequences. The provided reference file must be the same reference file used when producing the BAM and BAM index files.</p>
<h3 id="offset">Offset</h3>
<p>An integer to offset the reported positions in the output. This does not change the frame or coordinates of coding sequences in the BED file.</p>
<p>It may be useful to provide an offset when providing a gene as a reference and gene products in the BED file, but want to report codon variants with respect to the entire chromosome. In this circumstance, the offset would be the position of the reference gene, with respect to the chromosome on which it resides.</p>
<h3 id="bed-file">BED File</h3>
<p>A <a href="https://bedtools.readthedocs.io/en/latest/content/general-usage.html">BED file</a> that specifies the coordinates of genes, with repsect to the provided reference. This BED file must be a BED4+ file and therefore contain at least the first 4 BED file columns. The "names" of these genetic regions in the BED4 file must be the same names used in the "genetic regions" column of the mutation database. Please refer to <a href="../formats">Data Formats</a> for more information.</p>
<h3 id="mutation-database">Mutation Database</h3>
<p>The mutation database describes specific mutations within the named genetic regions specified previously in the BED4 file. The entries in the "genetic regions" colummn of this database must match the "names" column of the provided BED4 file. Please refer to <a href="../formats">Data Formats</a> for more information.</p>
<h2 id="options">Options</h2>
<h3 id="error-rate">Error Rate</h3>
<pre><code class="text">-e, --error_rate FLOAT
</code></pre>

<p>This is the expected substitution sequencing error rate. The default value is 0.0021 substitutions per sequenced base.</p>
<h3 id="output">Output</h3>
<pre><code class="text">-o, --output FILENAME
</code></pre>

<p>The file output location to write the identified amino acid mutations.</p>
<h2 id="example">Example</h2>
<h3 id="data">Data</h3>
<ul>
<li><a href="../data/variant.bam">variant.bam</a></li>
<li><a href="../data/variant.bai">variant.bai</a></li>
<li><a href="../data/hiv.fasta">hiv.fasta</a></li>
<li><a href="../data/hiv.bed">hiv.bed</a></li>
</ul>
<h3 id="command">Command</h3>
<pre><code class="bash">quasitools call codonvar variant.bam hiv.fasta 0 hiv.bed
</code></pre>

<h3 id="output_1">Output</h3>
<pre><code class="text">#gene,nt position (gene),nt start position,nt end position,ref codon,mutant codon,ref AA,mutant AA,coverage,mutant frequency,mutant type,NS count,S count
vpu,5607-5855,5706,5708,tta,Ata,L,I,118,100.00,NS,1.0000,0.0000
nef,8342-8713,8630,8632,ctg,Ttg,L,L,143,100.00,S,0.0000,1.0000
pol,1630-4641,2050,2052,att,aGt,I,S,145,100.00,NS,1.0000,0.0000
pol,1630-4641,2986,2988,gaa,gaG,E,E,107,100.00,S,0.0000,1.0000
pol,1630-4641,2419,2421,ctg,ctC,L,L,143,100.00,S,0.0000,1.0000
pol,1630-4641,1654,1656,cta,ctC,L,L,110,100.00,S,0.0000,1.0000
pol,1630-4641,1915,1917,gga,gAa,G,E,128,100.00,NS,1.0000,0.0000
pol,1630-4641,2365,2367,caa,caT,Q,H,139,100.00,NS,1.0000,0.0000
env,5770-8340,5968,5970,aat,aCt,N,T,116,100.00,NS,1.0000,0.0000
env,5770-8340,6136,6138,acc,acG,T,T,134,100.00,S,0.0000,1.0000
env,5770-8340,7363,7365,gca,gcC,A,A,128,100.00,S,0.0000,1.0000
env,5770-8340,6673,6675,aat,Tat,N,Y,138,100.00,NS,1.0000,0.0000
gag,335-1837,1655,1657,tac,tCc,Y,S,109,100.00,NS,1.0000,0.0000
gag,335-1837,716,718,gtc,gtG,V,V,131,100.00,S,0.0000,1.0000
gag,335-1837,341,343,gcg,Ccg,A,P,140,100.00,NS,1.0000,0.0000
gag,335-1837,1022,1024,gaa,gaT,E,D,126,100.00,NS,1.0000,0.0000
gag,335-1837,1349,1351,cca,cAa,P,Q,133,100.00,NS,1.0000,0.0000
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../ntvar/" class="btn btn-neutral float-right" title="call ntvar">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../aavar/" class="btn btn-neutral" title="call aavr"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright Government of Canada 2017-2018</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../aavar/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../ntvar/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
